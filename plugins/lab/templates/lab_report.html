{% extends 'static_base.html' %}


{% block title %}
<style>
  @media print{
    @page {
      size: auto;
      margin-left: 3cm;
      margin-right: 3cm
    }
  }
</style>
Lab report
(<a href="/#/patient/{{ object.patient_id }}">
{{ object.patient.demographics.name }}
</a>)
{% endblock %}

{% block page_content %}
<div class="lab-report">
  <div class="row print-only">
    <div class="col-xs-12">
      <h2 class="text-center">
        {{ object.patient.demographics.name }}
        {% if object.patient.demographics.date_of_birth %}
          ({{ object.patient.demographics.date_of_birth }})
        {% endif %}
      </h2>
    </div>
  </div>
  <div class="row content-offset-20">
    <div class="col-xs-6">
      <div class="row">
        <div class="col-xs-5 col-md-3">
          Ref num:
        </div>
        <div class="col-xs-7 col-md-9">
          {{ object.referral.reference_number }}
        </div>
      </div>
    </div>
    <div class="col-xs-6">
      <div class="row">
        <div class="col-xs-5 col-md-3">
          Exposure:
        </div>
        <div class="col-xs-7 col-md-9">
          {{ object.exposure }}
        </div>
      </div>
    </div>
  </div>
  <div class="row content-offset-10">
    <div class="col-xs-6">
      <div class="row">
        <div class="col-xs-5 col-md-3">
          Employer:
        </div>
        <div class="col-xs-7 col-md-9">
          {{ object.employment.employer }}
        </div>
      </div>
    </div>
    <div class="col-xs-6">
      <div class="row">
        <div class="col-xs-5 col-md-3">
          OH Provider:
        </div>
        <div class="col-xs-7 col-md-9">
          {{ object.employment.oh_provider }}
        </div>
      </div>
    </div>
  </div>
  <div class="row content-offset-10">
    <div class="col-xs-6">
      <div class="row">
        <div class="col-xs-5 col-md-3">
          Referrer:
        </div>
        <div class="col-xs-7 col-md-9">
          {% if referral %}
          {{ referral.referrer_name }}
          {% endif %}
        </div>
      </div>
    </div>
    <div class="col-xs-6">
      <div class="row">
        <div class="col-xs-5 col-md-3">
          Sample received:
        </div>
        <div class="col-xs-7 col-md-9">
          {% if object.blood_date %}{{ object.blood_date }}{% endif %}
        </div>
      </div>
    </div>
  </div>
  <div class="row content-offset-10">
    <div class="col-xs-6">
      <div class="row">
        <div class="col-xs-5 col-md-3">
          Blood number:
        </div>
        <div class="col-xs-7 col-md-9">
          {{ object.blood_number }}
        </div>
      </div>
    </div>
    <div class="col-xs-6">
      <div class="row">
        <div class="col-xs-5 col-md-3">
          Method:
        </div>
        <div class="col-xs-7 col-md-9">
          {{ object.method }}
        </div>
      </div>
    </div>
  </div>
  <div class="row content-offset-10">
    <div class="col-xs-6">
      <div class="row">
        <div class="col-xs-5 col-md-3">
          Report date:
        </div>
        <div class="col-xs-7 col-md-9">
          {% if object.report_dt %}{{ object.report_dt }}{% endif %}
        </div>
      </div>
    </div>
  </div>
  <div class="row content-offset">
    <div class="col-md-9 col-xs-12">
      <table class="table">
        <thead>
          <tr>
            <th>Allergen</th>
            <th>Result</th>
          </tr>
        </thead>
        <tbody>
          {% for result in object.bloodresult_set.all %}
          {# For int/float fields make sure they show if they are 0 #}
          {% if result.kul or result.rast is not None or result.rast_score is not None or result.precipitin or result.igg is not None %}
          <tr>
            <td>
              {{ result.allergen }}
              {% if result.antigenno %}
              ({{ result.antigenno }})
              {% endif %}
            </td>
            <td>
              {% if result.kul %}
                {{ result.kul }} KU/L
              {% endif %}
              {% if result.rast is not None  %}
                {{ result.rast }} %B
              {% endif %}
              {% if result.rast_score is not None  %}
                {{ result.rast_score }}
              {% endif %}
              {% if result.precipitin %}
                {{ result.precipitin }}
              {% endif %}
              {% if result.igg is not None  %}
                {{ result.igg }} mg/L
              {% endif %}
            </td>
          </tr>
          {% endif %}
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>

{% endblock %}